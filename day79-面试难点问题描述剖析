1、	Linux性能优化实战
1）	作为运维工程师来讲，最主要的工作保障：企业门户网站、业务系统、应用程序、软件高效稳定的运行，密切关注业务系统、操作系统性能，对业务系统、操作系统实施性能优化，使其发挥最大的性能；
2）	影响Linux服务器、业务网站等性能因素有哪些层面呢？
	硬件层面
CPU、内存、硬盘容量、硬盘I/O读写、网卡自身带宽容量等，通常对硬件层面因素的优化主要是考虑增加其配置；
	软件层面
Linux系统下各个应用程序：Nginx、Tomcat、MYSQL、Redis、程序代码、网站代码等，对其网站代码、软件的配置文件参数优化、优化软件架构、是否增加集群、分布式结构以扩展软件的本身的性能；
	系统层面
选择比较稳定的Linux操作系统发行版、减少不必要的服务、端口、修改Linux内核自身的限制、对Linux内核实施优化（打开端口数、进程数、文件数等）；
	网络层面
引入性能比较强硬件网络设备、交换机、路由器、防火墙，增加网络设备的背板带宽、带宽容量、吞吐率、运营商购买带宽容量等；
3）	Linux系统性能评估标准如表15-1所示：
影响性能因素	评判标准
	好	坏	糟糕
CPU	user% + sys%< 70%	user% + sys%= 85%	user% + sys% >=90%
内存	Swap In（si）＝0
Swap Out（so）＝0	Per CPU with 10 page/s	More Swap In & Swap Out
磁盘	iowait % < 20%	iowait % =35%	iowait % >= 50%
 
#清理Linux目录磁盘空间，通过rm删除了，空间还没有释放，因为删除进程还存在，将删除进程kill，空间即可释放：
lsof|grep deleted|awk '{print $2}'|xargs kill -9
 
常用系统性能分析命令；
vmstat、sar、iostat、netstat、free、ps、top、iftop、iotop等；
常用系统性能组合分析命令；
top、uptime                      检查系统整体的负载、承受能力；
vmstat、sar、iostat	、top		检测是否是CPU瓶颈；
free、vmstat					    检测是否是内存瓶颈；
iostat、iotop						检测是否是磁盘I/O瓶颈；
netstat、iftop					    检测是否是网络带宽瓶颈。
4）	以Linux内核优化为案例，对Linux内核进行优化，使其Linux系统自身发挥最大的性能，突破Linux内核自身的限制，为什么有Linux内核优化概念呢？
5）	因为Linux内核（操作系统）最初设计的时候，做了很多的限制，限制很多参数、资源使用，为了防止Linux系统资源不被恶意使用、大量的使用而导致资源枯竭而设计内核限制；
6）	在生产环境中，由于某些软件、应用程序发挥最大的性能，使用Linux内核默认资源显然不够的，要对Linux内核资源进行重新修改和调整，对Linux内核资源进行优化；
默认Linux内核对每个用户设置了打开文件最大数为1024，对于高并发网站，是远远不够的，需要将默认值调整到更大，调整方法有两种：
Linux每个用户打开文件最大数临时设置方法，重启服务器该参数无效，命令行终端执行如下命令：
ulimit   -n  65535
Linux每个用户打开文件最大数永久设置方法，将如下代码加入内核限制文件/etc/security/limits.conf的末尾：
* 	soft 	noproc			65535
* 	hard 	noproc			65535
* 	soft 	nofile			65535
* 	hard 	nofile			65535
如上设置为对每个用户分别设置nofile、noproc最大数，如果需要对Linux整个系统设置文件最大数限制，需要修改/proc/sys/fs/file-max中的值，该值为Linux总文件打开数，例如设置为：echo 3865161233 >/proc/sys/fs/file-max。
2、	面试难点问题描述剖析
1）面试自我介绍？ （2-3分钟）
你好，我是王超，2014年毕业北京xx大学，毕业之后在xx公司从事Linux运维工作，平时主要工作内容： 
	主要是负责公司企业门户网站稳定的运行；
	编写SHELL脚本对100服务器批量管理和维护；
	构建企业Zabbix监控平台7x24小时监控设备、服务状态，有问题及时解决；
我自己的性格比较踏实、稳重，能够吃苦，平时业余爱好打羽毛球、旅游、爬山、看书（Linux运维实战）等，其他的没了，谢谢！
2）你们原来公司的网站架构是怎样的？
	我们公司架构总共分为三层，其中前端2台Nginx+Keepalived双机互备+高可用，中间层由JAVA集群组成的应用层，后端MYSQL+Redis+NFS组成的；
	公司服务器台数：50台（尽量自己画出架构图）
	前端2台Nginx高可用+负载均衡；
	中间层：32台JAVA集群：Search服务12台（s.map.com）、BUS服务6台(b.map.com)、Route 6台(r.map.com)、其他8台；
	后端数据库：2主-4从+Keepalived+DRBD、Redis 1主2从、NFS存储 2台（20T），存储地图图片+网站静态图片+静态文件；
	CDN（分布式内容缓存网络），可以加速网站的访问，用第三方的：蓝汛、帝联、网宿等；
3）你们公司的网络出口带宽是多少？每天网站的PV、UV是多少？中小型公司IP、PV、UV：
	PV（page view）：50w
	UV（uniq vistor）：5w
	独立IP（uniq IP）：3w
	网站并发：500000（PV）/8（小时）/3600（秒）=17/s，每秒访问20个PV；
	网站带宽：首页大小50KB x 500每秒并发=25000KB=25Mb；
4）你为什么离职，离职的原因是什么？
	公司经常性拖欠工资；
	公司确实倒闭了，经济不好；
	公司离家比较远，照顾家人，稍微近一点；
	家里有事情，休假，重新来找工作；
	原来公司产品线比较稳定、工作太闲，年轻不想安于现状；
	千万不要说：
老加班、工资少、上家公司不好、领导不行、同事关系差、公司环境差等，批评别人的不要说、不要说更好的考虑好平台；
5）你的期望薪资是多少？
	IT行业跳槽，薪资涨幅不能超过20-30%；
	现在薪资（税前）9K，期望薪资：12K；
	现在薪资15K，期望薪资18K；（思考）

DNS&CDN简介
随着原中国电信集团按南北地域分家,新的中国电信和网通集团随即成立,互联网的骨干网也被一分为二了，北有网通、南有电信。从此，细心的网民可以发现,有些经常访问的网站速度一下子慢了下来，有时候还有访问不到的情况出现。例如北方地区的网络用户访问中国网通的服务器会非常快，而访问中国电信的服务器时，感觉非常慢。
这种现象不仅影响了网站的访问量,更严重的是它直接影响了一些经营性网站的经济效益。据分析,产生这个问题的根本原因是中国电信分家之后，电信与网通之间的互连存在问题。虽然信息产业部已经在规划南北互通计划，但在今后相当长的一段时期内,南北方网互连的问题还会长期存在。
智能DNS策略解析很好的解决了上面上面的问题。DNS策略解析最基本的功能是可以智能的判断访问您网站的用户，然后根据不同的访问者把您的域名分别解析成不同的IP地址。如访问者是网通用户，DNS策略解析服务器会把你的域名对应的网通IP地址解析给这个访问者。DNS策略解析服务器会把您域名对应的电信IP地址解析给这个访问者。
目前免费的国内智能DNS服务商：https://www.dnspod.cn/ 
智能DNS解析的条件：
1、必须先将域名的dns服务器先修改为提供智能解析的服务商NS域名，例如DNSPOD智能解析，首先要将域名的DNS修改为：
f1g1ns1.dnspod.net
f1g1ns2.dnspod.net 
2、必须同时拥有电信和网通或者其他链路两个及多个线路的IP，然后分别在DNSPOD做解析。
简单来说：智能dns解析的技术原理：电信用户访问电信服务器，网通用户访问网通服务器，其他线路用户，根据您设置的默认其他线路的解析服务器来决定访问电信或网通的服务器。
CDN技术入门简介
CDN（Content Delivery Network）即内容分发网络。通过在现有的Internet中增加一层新的网络架构，部署边缘服务器，将网站的内容发布到最接近用户的Cache服务器，使用户可以就近取得所需的内容，实现用户就近访问，有效提升网站的访问效果、安全性和稳定性。
附CDN简单拓扑图：
 
CDN的实现需要依赖多种网络技术的支持，其中负载均衡技术、动态内容分发与复制技术、缓存技术是比较主要的几个，下面让我们简单看一下这几种技术。
负载均衡技术
负载均衡技术不仅仅应用于CDN中，在网络的很多领域都得到了广泛的应用，如服务器的负载均衡、网络流量的负载均衡。顾名思义，网络中的负载均衡就是将网络的流量尽可能均匀分配到几个能完成相同任务的服务器或网络节点上，由此来避免部分网络节点过载。这样既可以提高网络流量，又提高了网络的整体性能。在CDN中，负载均衡又分为服务器负载均衡和服务器整体负载均衡(也有的称为服务器全局负载均衡)。GSLB
服务器负载均衡是指能够在性能不同的服务器之间进行任务分配，既能保证性能差的服务器不成为系统的瓶颈，又能保证性能高的服务器的资源得到充分利用。而服务器整体负载均衡允许Web网络托管商、门户站点和企业根据地理位置分配内容和服务。
通过使用多站点内容和服务来提高容错性和可用性，防止因本地网或区域网络中断、断电或自然灾害而导致的故障。
在CDN的方案中服务器整体负载均衡发挥着重要作用，其性能高低将直接影响整个CDN的性能。如图所示的全局调度服务器就可以看做一个服务器全局负载均衡。它根据网民的位置决定CDN系统哪个Cache服务器为网民服务。
在使用CDN服务的时候，全局调度服务器可以进行智能域名解析，网站需要将原来的域名CNAME到全局调度服务器智能解析的域名上，这样CDN的工作就做到了对网民的透明，网民可以访问到部署在边缘的Cache服务器。
具体到一个Cache节点，对网民看是一个的服务个体，其实内部实现也是一个服务器负载均衡。当单台服务器不能满足该地区的Cache业务时，负载均衡器扮演了重要角色，它将Cache服务集群联系到一起，其服务能力也是多台Cache服务能力的总和。

动态内容分发与复制技术
大家都知道，网站访问响应速度取决于许多因素，如网络的带宽是否有瓶颈、传输途中的路由是否有阻塞和延迟、网站服务器的处理能力及访问距离等。多数情况下，网站响应速度和访问者与网站服务器之间的距离有密切的关系。如果访问者和网站之间的距离过远的话，它们之间的通信一样需要经过重重的路由转发和处理，网络延误不可避免。
为了避免网络延误，就需要一个有效的方法将占网站主体的大部分静态网页、图像和流媒体数据分发复制到各地的加速节点上。同时在国内又有南北互联的问题，电信联通间的访问速度非常不好，所以动态内容分发和复制技术显得更为必要，因此动态内容分发与复制技术也是CDN所需的一个主要技术。

缓存技术
缓存技术已经不是一种新鲜技术。Web缓存服务通过几种方式来改善用户的响应时间，如代理缓存服务、透明代理缓存服务、使用重定向服务的透明代理缓存服务等。通过Web缓存服务，用户访问网页时可以将广域网的流量降至最低。对于公司内联网用户来说，这意味着将内容在本地缓存，而无须通过专用的广域网来检索网页。对于Internet用户来说，这意味着将内容存储在他们的ISP的缓存器中，而无须通过Internet来检索网页。这样无疑会提高用户的访问速度。CDN的核心作用正是提高网络的访问速度，所以，缓存技术将是CDN所采用的又一个主要技术。
如图示，各地的Cache服务器保存着源站静态内容的一份有效拷贝，网民无需直接访问源站，就可以在离自己最近的Cache服务器上获得新鲜正确的内容。目前缓存服务器可以有多种选择，大名鼎鼎的squid，还有ngnix（ncache），vanish都可以用作Cache服务器。Cache服务器的主要工作提高内容HIT率，使得大多数的访问都能在Cache设备获得，而不用MISS回源去取.技术要点是过期机制等内容更新管理，此外Cache服务器可以将源站的一些功能分担出来，实现起来更加灵活。
综上，CDN从技术上解决由于网络带宽小、用户访问量大、网点分布不均等原因所造成的用户访问网站响应速度慢的问题，关注全国范围内不同网络中的用户都能得到优质的访问质量的网站可以采用CDN来提高网站的体验水平。
初期我国CDN市场发展缓慢，2006年后市场陡然升温。国内整体CDN市场规模、运营成熟度、服务能力和技术研发均较国外存在一定的差距。
常见的CDN厂商，例如：蓝汛、帝联、网宿及自建CDN（阿里、腾讯、百度、新浪、乐视）等等。



